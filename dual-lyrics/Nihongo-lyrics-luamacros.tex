% !TeX encoding = UTF-8
% !TeX program = LuaLaTeX

%\documentclass[12pt]{article}

%\usepackage{luatexja-preset}
%\usepackage{fontspec}
\usepackage[no-math]{luatexja-fontspec}
\usepackage{luatexja-ruby}
\usepackage{color}

\topmargin=-0.95in      %
\evensidemargin=0in     %
\oddsidemargin=0in      %
\textwidth=6.5in        %
\textheight=9.75in       %
\headsep=0.25in

\setmainfont{Noto Sans CJK JP}
\setmainjfont{Noto Sans CJK JP}

\makeatletter
\def\dynscriptsize{\check@mathfonts\fontsize{\sf@size}{\z@}\selectfont}
\makeatother
\def\textunderset#1#2{\leavevmode
  \vtop{\offinterlineskip\halign{%
    \hfil##\hfil\cr\strut#2\cr\noalign{\kern-.3ex}
    \hidewidth\dynscriptsize\strut#1\hidewidth\cr}}}

\newcommand{\zhuyin}[2]{\ruby{#1}{#2}}
\newcommand{\kanji}[2]{\textunderset{#1}{\textcolor{blue}{#2}}}
\newcommand{\trans}[1]{\hspace{1em} \unskip
  \nobreak \hfil \penalty1000 \hfilneg \indent
\strut\hfill \mbox{\def\z{\zhuyin}\small #1}}
\newcommand{\jisho}[1]{}

\newcommand{\lyrics}[2]{\begingroup
\def\z{\zhuyin}
\list{}{\leftmargin0em}
\setlength\itemsep{1em}
  #1
\endlist
\newpage
\def\z{\kanji}
\list{}{\leftmargin0em}
\setlength\itemsep{1em}
  #1
\endlist
\endgroup}
